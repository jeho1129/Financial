# final-pjt

## 팀원 정보 및 업무 분담
- 이지호(팀장) : BackEnd(DRF)
  - 세부 역할
    - 회원 커스터마이징을 위한 User Model 구현
    - 금융 상품 데이터 저장 및 조회 기능 구현
    - 금융 상품 리뷰 기능 구현
    - 환율 데이터 요청 및 전송
    - 커뮤니티 기능을 위한 글, 댓글 Model 구현
    - 금융 상품 추천 알고리즘 구현

- 정태윤(팀원) : FrontEnd(Vue)
  - 세부 역할
    - 메인 페이지 구현
    - 계정 관리, 프로필 페이지 구현
    - 금융 상품 전체 조회 및 상세 조회 페이지 구현
    - 환율 데이터 출력
    - 근처 은행 정보 API 이용하여 정보 출력
    - 커뮤니티 페이지 구현
    - 상품 추천 페이지 구현

##
## 전체 일정 및 실제 구현 정도
- 11/16(목)
  - Front
    - URL, View, Component 파일 기본 틀 구성
    - Navbar, 회원가입, 로그인 UI 제작
  - Back
    - 데이터베이스 모델링 구성 및 ERD 제작
    - 회원 커스터 마이징 기능 구현
- 11/17(금)
  - Front
    - 메인 / 금융 상품 비교 / 커뮤니티 페이지 UI 제작 및 개발
  - Back
    - 금융 상품 모델 설계 및 API 이용하여 DB에 저장
    - 금융 상품 전체 조회 / 상세 조회 / 리뷰 기능 구현
    - 환율정보 API 이용하여 데이터 받아오기 / 프론트에 전송
    - 커뮤니티 기능 구현을 위한 글, 댓글 Model 설계
    - 글, 댓글 생성 / 조회 / 수정 / 삭제 기능 구현
- 11/20(월)
  - Front
    - 게시판 삭제 및 댓글 생성 / 삭제 개발
  - Back
    - 금융 상품 추천 알고리즘 구현
- 11/21(화)
  - Front
    - 적금상품 비교 및 예금 / 적금 상세 정보 개발
  - Back
    - 금융 상품 추천 알고리즘 검증
    - 금리 정보 수정 기능 및 메일 전송 기능 구현
- 11/22(수)
  - Front
    - 환율 계산, 지도 개발
  - Back
    - 전체 기능 검증 및 오류 수정
- 11/23(목)
  - 여유될 때 추가 기능 구현 예정
  - 발표 자료 제작
- 실제 구현 정도 : 추가 기능은 시간 여건 상 구현을 하지 못했지만, 요구 사항에 기재된 필수 기능과 도전 과제는 모두 구현했습니다.

##
## 일정별 설계 진행 과정
## 1일차(2023-11-16)

### Back

- 데이터베이스 모델링(ERD)
  - 우선 모든 서비스의 기본이 되는 User Model을 중심으로 User Model과 1:N 관계를 가지는 예금 모델, 적금 모델을 설정하였고, 예/적금 모델과 1:N 관계를 가지는 예/적금 옵션 모델을 추가적으로 설정하였습니다. 또한, 예/적금 상세 조회 페이지에서 해당 상품에 대한 리뷰 기능을 구현하기 위해 예/적금 모델 및 User Model과 1:N 관계를 가지는 Review 모델 또한 설정하였습니다.
  - 근처 은행 검색 기능을 구현하기 위해 Bank Model을 구현하였습니다.
  - 커뮤니티 기능을 구현하기 위해 Article, Comment Model을 추가적으로 구현하였습니다.

- 회원 커스터마이징 기능 구현
  - 필수 요구사항 중 회원 커스터마이징 기능을 구현하였습니다.
  - 회원 관리 라이브러리인 allauth와 dj-rest-auth를 이용하여 기본 User Model을 상속받아 커스텀 User Model과 Serializer를 구성하였습니다.
  - 추가 field로 유저의 닉네임에 해당하는 nickname, 유저의 나이에 해당하는 age, 유저의 자산에 해당하는 asset, 유저의 연봉에 해당하는 salary, 유저가 가입한 상품 목록인 financial_products field를 생성하였습니다.
  - 또한, 회원 정보 확인 / 수정 / 탈퇴 기능을 나누어 구현하기 위해 url에 해당하는 view 함수의 method를 GET, PUT, DELETE로 나누었습니다.
  - method가 GET일 경우에는 유저의 모든 정보를 확인할 수 있도록 User model의 모든 Field를 확인할 수 있는 Serializer를 통해 해당 유저의 정보를 출력할 수 있도록 구현하였습니다.
  - method가 PUT일 경우에는 수정 가능한 정보만 수정할 수 있도록, 별도의 Serializer를 통해 수정할 수 있는 필드를 지정해준 다음, 모든 정보가 아닌 일부분의 정보만 수정해도 제출이 가능하도록 partial=True 인자를 추가하여 view 함수를 구현하였습니다.
  - method가 DELETE인 경우에는 회원 탈퇴가 가능하도록 delete() 함수를 이용하여 view 함수를 구현하였습니다.

## 2일차(2023-11-17)

### Back

- 금융 상품 데이터 저장 및 조회
  - 금융상품통합비교공시 API를 이용하여 정기 예금 및 적금 데이터를 받아와 DB에 저장하였습니다.
  - 전체 상품 목록, 해당 상품에 대한 상세 상품 목록을 확인할 수 있도록 Model을 설계하고, View 함수를 구현하였습니다.
  - 해당 상품에 대한 리뷰 기능을 구현할 수 있도록 Review Model을 설계하고, 댓글을 작성 및 수정, 삭제할 수 있는 View 함수를 구현하였습니다.
- 환율 데이터 요청 및 전송
  - 한국수출입은행 환율정보 API를 이용하여 데이터를 받아온 이후 JSON 형식으로 출력할 수 있도록 View 함수를 구현하였습니다.
- 커뮤니티 기능 구현
  - 글, 댓글 Model을 구현하고, 게시글 및 댓글 조회, 생성, 삭제, 수정 기능을 구현할 수 있도록 이에 해당하는 URL과 View 함수를 구현하였습니다.

### Front

- 로그인, 회원가입 기능 구현
  - 회원가입 후 자동 로그인이 가능하다.
- 게시글 조회 및 생성 기능 구현
  게시글 클릭 시 해당 게시글의 상세 페이지로 이동한다.
- 메인 페이지 인기 예금, 적금 조회
  - 메인 페이지에 가입자가 많은 상위 4개의 예금, 적금 조회 및 더보기 클릭 시 예금적금 비교 페이지로 이동

## 3일차(2023-11-20)

### Back

- 금융 상품 추천 알고리즘 구현
  - Item-Based Collaborative Filtering을 이용한 알고리즘을 구현하였습니다.
  - Item-Based Collaborative Filtering 알고리즘은 사용자의 행동 패턴을 분석하여, 사용자가 아직 평가하지 않은 아이템 중에 사용자가 선호할 만한 아이템을 찾아내는 방법입니다.
  - 이를 위해 각 금융 상품 모델 필드에 Integer 타입의 Review 필드를 추가하여 사용자가 가입한 상품을 평가할 수 있는 기능을 구현하여 이를 기반으로 알고리즘을 구현하였습니다.
  - 또한, 사용자가 아직 아무런 아이템도 평가하지 않았거나, 모든 아이템의 유사도가 0일 경우에는 대신 인기도가 가장 높은 아이템 순서로 추천하는 로직을 추가하였습니다.

- 금융 상품 가입 기능 구현
  - 기존 금융 상품 상세 정보를 확인하는 view 함수에서 POST Method를 추가하여 사용자가 상품을 가입할 수 있도록 하였습니다.
  - 또한 이미 가입한 상품일 경우, 사용자가 가입을 취소할 수 있도록 하는 기능도 추가적으로 구현하였습니다.

- 관리자 권한으로 수정 및 메일 전송 기능 구현
  - view 함수를 추가하여 decorator를 통해 관리자일 경우에만 금리 정보를 수정할 수 있도록 구현하였습니다.
  - 또한, django.core.mail 모듈과 네이버 호스트 서버를 이용하여 금리 정보가 수정될 경우 가입한 유저의 이메일로 수정 정보가 전송되도록 구현하였습니다.

- 정리
  - 예상보다 오늘 구현하고자 하는 기능 구현이 수월하게 되어 내일은 알고리즘 최종 검증 및 다른 방법을 이용한 알고리즘 구현, 전체적인 view, url, models, serializer 점검 및 오류 수정, 디테일한 기능을 구현할 예정입니다.

## 4일차(2023-11-21)

### Back

- 유저 모델 필드 수정
  - 유저가 가입한 상품 목록을 TextField로 저장했을 때, 이후에 이를 이용하는 로직을 구현할 때 불편함이 있어, TextField에서 JSONField로 변경하여 가입한 상품의 모든 정보가 다 저장될 수 있도록 하였습니다.

- 금융 상품 가입 Model 구현
  - 사용자가 상품을 가입할 때, 금액과 가입 개월 수를 입력했을 때, 이를 이용하여 현재 날짜를 기반으로 만기일을 자동으로 계산하고, 이를 개별 Model로 저장하기 위해 가입 관련 DB를 저장할 수 있는 Model을 추가적으로 구현했습니다.

- 알고리즘 추가
  - 기존 Item-based Collaborative Filter 알고리즘에 더해 사용자의 나이대, 직업, 자산, 연봉 정보를 이용하여 필터링을 통해 비슷한 나이대 / 자산 / 연봉 혹은 같은 직업대의 사람들이 가장 많이 가입한 상품을 추천하는 기능을 추가적으로 구현할 수 있도록 알고리즘을 추가하였습니다.

- 정리
  - 오늘부로 필수적으로 구현해야 하는 기능과 도전과제까지 Backend에서 해야할 설계는 거의 마무리되었습니다. 내일은 Frontend와 같이 기능을 검증하면서 오류가 발생했을 때 수정을 하고, 추가 기능이 필요하면 구현할 예정입니다.

## 5일차(2023-11-22)

### Back

- 비밀번호 변경 로직 추가
  - 유저 정보 수정 기능에서 비밀번호도 변경할 수 있도록 비밀번호 변경 및 비밀번호 확인란으로 받은 비밀번호와 검증하여 일치할 경우에만 비밀번호가 수정되도록 하는 기능을 구현하였습니다.

- 관리자 권한으로 상품 수정 로직 수정
  - 금리를 일부만 수정해도 수정 사항이 반영될 수 있도록 로직을 수정하였습니다.

- 알고리즘 시각화
  - 추천 알고리즘을 시각적으로 확인할 수 있도록 seaborn, matplotlib 라이브러리를 이용하여 데이터프레임을 시각화하는 작업을 진행하였습니다.

- 정리
  - 오늘은 기능 구현보다는 기능 동작 과정에서 오류가 발생할 수 있는 부분을 찾아 수정하는 과정을 중점으로 작업을 진행하였습니다. 내일은 발표 자료를 제작할 예정입니다.

## 6일차(2023-11-23)

### Back

- 상품 가입 로직 수정
  - 처음 모델 설계 당시, 가입 개월 수를 입력받아 그에 해당하는 옵션을 가입하도록 설정하였는데 검증 시에 가입 개월 수가 동일한 옵션이 여러 개가 존재하는 상품이 있다는 것을 확인하였습니다. 따라서 가입 개월 수가 아닌 option_id를 입력받도록 하여 상품 가입 중개 모델 필드를 수정하였습니다.

- 메일 오류 수정
  - 일부 상품 이름에 \n 개행 문자가 포함되어있어, django-mail 모듈 내에서 에러가 발생하는 현상을 확인했습니다. 따라서 메일 전송 시 상품 이름에 개행 문자가 포함되어 있을 경우, 개행 문자를 제거하는 로직을 추가하였습니다.

- 권한에 따른 게시글, 댓글 수정 및 삭제 로직 설정
  - 본인이 작성한 게시글, 댓글만 수정 및 삭제할 수 있도록 로직을 추가하였습니다.
  - 또한 관리자 계정일 경우, 모든 게시글과 댓글을 삭제할 수 있도록 로직을 추가하였습니다.

## 설계 내용 및 데이터베이스 모델링(ERD)
- Django URL 정리
![URL](final_pjt_back/URL.JPG)
- 데이터베이스 모델링(ERD)
![ERD](final_pjt_back/ERD_MIDDLE.png)

## 금융 상품 추천 알고리즘
- 이번 프로젝트에서 2가지의 추천 알고리즘을 이용하여 금융 상품을 추천할 수 있도록 하였습니다
1. Categorical Variable Based Filtering(범주형 변수 기반 필터링)
  - 사용자의 개인적 특성과 유사한 그룹이 선호하는 아이템을 추천하는 알고리즘입니다.
  - 사용자의 나이, 직업, 연봉, 자산 등을 기준으로 사용자와 가장 비슷한 특성을 가진 다른 사용자들이 가입한 예금 상품과 적금 상품을 추천하는 로직입니다.
  - 필터링된 각 사용자 그룹에서 인기 많은 상품 순으로 정렬하여 항목을 추천받을 수 있도록 하였습니다.
  - 구체적인 동작 과정
    1. 사용자의 나이, 직업, 연봉, 자산을 기준으로 사용자와 유사한 특성을 가진 다른 사용자들을 필터링합니다. 나이는 +- 5살 이내, 연봉과 자산은 백만원 단위로 그룹을 나눠 필터링합니다.
    2. 각 필터링된 사용자 그룹에서 가입한 예금 상품과 적금 상품의 코드를 가져옵니다.
    3. 각 상품 코드를 카운트하고, 카운트가 많은 순서대로 정렬합니다. 이를 통해 많이 가입된 상품을 추천합니다.
    4. 각 카테고리(나이, 직업, 연봉, 자산)별로 상위 5개의 예금 상품과 적금 상품을 추천합니다.
    5. 만약 특정 카테고리에서 추천할 상품이 없는 경우(해당 그룹 사용자 표본이 부족할 경우), 해당 상황을 알려주는 메세지를 반환합니다.
  - 범주형 변수 기반 필터링은 사용자를 그룹화하고 그룹의 선호도를 기반으로 추천을 하기에, 개별 사용자의 세부적인 취향이나 선호도를 정확하게 반영하는 데 한계가 있습니다. 따라서 이 한계점을 극복하기 위한 알고리즘을 추가적으로 구현하였습니다.
2. Item-based Collaborative Filtering(아이템 기반 협업 필터링)
  - 현재 넷플릭스, 아마존, 쿠팡에서 사용 중인 알고리즘인 아이템 기반 협업 필터링 알고리즘은 사용자의 행동 패턴(여기서는 금융 상품에 대한 평점)을 분석하여 사용자가 아직 평가하지 않은 아이템의 선호도를 예측하여 사용자가 선호할 만한 아이템을 찾아 추천하는 알고리즘입니다.
  - 코사인 유사도를 이용하여 아이템 간의 유사도를 계산하여, 사용자가 선호하는 아이템과 유사도가 높은 아이템을 추천합니다.
  - Dummy Data 평점 정보
  ![Rating](final_pjt_back/Dummy%20Data%20평점%20정보.png)
  - 구체적인 동작 과정
    1. 모든 사용자의 상품 평점 정보를 가져와 피벗 테이블을 생성합니다. 이 피벗 테이블은 행이 사용자, 열이 상품, 값이 평점인 형태를 가집니다.
    2. 코사인 유사도를 이용하여 상품 간 유사도를 계산합니다. 이 유사도는 상품 간 평점 패턴의 유사성을 나타냅니다.
    ![Cosine_Similarity](final_pjt_back/Seaborn%20Heatmap(Deposit).png)
    3. 함수 호출 시, 특정 사용자의 상품 평정 정보를 가져옵니다. 이 사용자가 평가한 상품들 중 가장 높은 평점을 받은 상품을 찾습니다.
    4. 가장 높은 평점을 받은 상품과 유사도가 높은 상품들을 찾습니다. 이 유사도는 2번에서 계산한 데이터프레임을 이용합니다.
    5. 유사도가 높은 상품들 중 일정 개수의 상품을 추천 리스트로 선정합니다.
  - Cold Start Problem
    - Item-based Collaborative Filtering의 한계점으로는 새로 가입한 유저나 신상품일 경우, 해당 정보를 수집할 수 없어 적절한 제품을 추천하지 못하는 문제인 Cold Start 문제가 존재합니다.
    - 이를 해결하기 위해, 사용자가 평가한 상품이 없거나 아이템 간 유사도가 없는 경우, 대신 가장 인기가 많은 아이템을 추천하여 문제를 해결하였습니다.

## 서비스 대표 기능
- ...

## 프로젝트 후기
- 이지호
  - 제가 이번 프로젝트를 진행하며 가장 큰 만족감을 느낀 부분은 지금까지 배운 지식들을 실제로 활용해 볼 수 있었다는 점입니다. 특히, Django와 REST Framework를 이용한 웹 개발, 그리고 추천 알고리즘 등의 지식을 이용해 실제 서비스를 구현하였습니다. 
  - 이 과정에서 Django의 ORM을 이용해 데이터베이스를 효율적으로 관리하고, RESTful API를 설계하여 프론트엔드와의 원활한 통신을 가능하게 했습니다. 또한, 사용자의 특성에 따른 상품 추천 알고리즘을 구현함으로써 개인화된 서비스 제공이 가능하게 되었습니다. 
  - 이러한 기술들을 실제 프로젝트에 적용하면서 이론에서 배운 지식이 실제로 어떻게 동작하는지를 체험할 수 있었고, 이를 통해 배운 지식의 깊이를 더욱 높일 수 있었습니다. 또한, 프로젝트를 통해 문제를 해결하는 과정에서 새로운 도전과 문제들을 마주하게 되었고, 이를 해결하기 위해 끊임없이 배우고 성장하는 경험을 할 수 있었습니다. 
  - 이런 경험은 단순히 지식을 습득하는 것 이상의 가치를 가지며, 이를 통해 제 자신이 어떤 문제 상황에서도 해결책을 찾아내는 능력을 키울 수 있었다는 점에서 큰 의미를 가진다고 생각합니다. 앞으로도 이런 경험을 바탕으로 더 많은 프로젝트에서 성공적인 결과를 만들어낼 수 있도록 노력하겠습니다.